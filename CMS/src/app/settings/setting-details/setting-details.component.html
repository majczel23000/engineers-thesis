<app-current-path *ngIf="setting" [currentPathItems]="['settings', setting.name]"></app-current-path>

<app-settings-navigation></app-settings-navigation>

<mat-card class="setting-details-card pb-5 mt-4">

  <mat-card-header>
    <mat-card-title>
      <h1 class="setting-details-title">setting: {{setting?.code}}</h1>
    </mat-card-title>
  </mat-card-header>

  <mat-card-content>
    <form class="setting-details-form" [formGroup]="editSettingFormGroup" *ngIf="setting" (ngSubmit)="editSetting()">

      <table class="setting-details-table">
        <tr class="setting-details-row">
          <td class="setting-details-item">Code:</td>
          <td class="setting-details-item" style="text-align: left">{{setting?.code}}</td>
        </tr>
        <tr class="setting-details-row">
          <td class="setting-details-item">Name:</td>
          <td class="setting-details-item">
            <mat-form-field>
              <input matInput value="{{setting?.name}}" name="name" formControlName="name" [errorStateMatcher]="matcher">
              <mat-error *ngIf="control.name.hasError('required')">
                Name is <strong>required</strong>
              </mat-error>
            </mat-form-field>
          </td>
        </tr>

        <tr class="setting-details-row">
          <td class="setting-details-item">Description:</td>
          <td class="setting-details-item">
            <mat-form-field>
              <input matInput value="{{setting?.description}}" name="description" formControlName="description" [errorStateMatcher]="matcher">
              <mat-error *ngIf="control.description.hasError('required')">
                Description is <strong>required</strong>
              </mat-error>
            </mat-form-field>
          </td>
        </tr>

        <tr class="setting-details-row">
          <td class="setting-details-item">Type:</td>
          <td class="setting-details-item">
            <mat-form-field class="type-value-fields">
              <mat-select formControlName="type" value="{{setting?.type}}">
                <mat-option *ngFor="let type of settingType" [value]="type">
                  {{type}}
                </mat-option>
              </mat-select>
              <mat-error *ngIf="control.type.hasError('required')">
                Type is <strong>required</strong>
              </mat-error>
            </mat-form-field>
          </td>
        </tr>

        <tr class="setting-details-row">
          <td class="setting-details-item">Value:</td>
          <td class="setting-details-item">
            <mat-form-field class="example-full-width mb-4 type-value-fields">
              <input matInput type="text" name="value" formControlName="value" [errorStateMatcher]="matcher" value="{{setting?.value}}">
              <mat-error *ngIf="control.value.hasError('required')">
                Value is <strong>required</strong>
              </mat-error>
              <mat-error *ngIf="typeStringError">
                Value for String type is <strong>invalid</strong>
              </mat-error>
              <mat-error *ngIf="typeNumberError && !control.value.hasError('required')">
                Value for Number type is <strong>invalid</strong>
              </mat-error>
              <mat-error *ngIf="typeBooleanError">
                Value for Boolean type is <strong>invalid</strong>
              </mat-error>
            </mat-form-field>
          </td>
        </tr>

        <tr class="setting-details-row">
          <td class="setting-details-item">Status:</td>
          <td class="setting-details-item setting-details-status" (click)="changeStatus()"
              [ngStyle]="{ 'background': setting.status === 'INACTIVE' ? '#828282' : '#28a745' }">{{setting?.status}}</td>
        </tr>

        <tr class="setting-details-row">
          <td class="setting-details-item">Created at:</td>
          <td class="setting-details-item" style="text-align: left">{{setting?.createdAt}}</td>
        </tr>
      </table>

      <mat-card-actions class="setting-edit-actions">
        <button mat-raised-button class="setting-edit-btn" color="primary">Save changes</button>
        <a mat-raised-button class="setting-edit-btn" (click)="clearChanges()" color="accent">Clear changes</a>
        <a mat-raised-button class="settings-edit-btn" color="warn" (click)="removeSetting()">Remove setting</a>
      </mat-card-actions>

    </form>
  </mat-card-content>

</mat-card>
